"0","d.full = regsubsets(y ~ ., data = data.frame(x = X_mat.train, y = Y.train), "
"0","                    nvmax = p)"
"0","d.summary = summary(d.full)"
"0","d.summary"
"1","Subset selection object
"
"1","Call: "
"1","regsubsets.formula(y ~ ., data = data.frame(x = X_mat.train, 
"
"1","    y = Y.train), nvmax = p)
"
"1","20"
"1"," Variables "
"1"," (and intercept)"
"1","
"
"1","    "
"1"," Forced in"
"1"," Forced out"
"1","
x.1 "
"1","     FALSE"
"1","      FALSE"
"1","
x.2 "
"1","     FALSE"
"1","      FALSE"
"1","
x.3 "
"1","     FALSE"
"1","      FALSE"
"1","
x.4 "
"1","     FALSE"
"1","      FALSE"
"1","
x.5 "
"1","     FALSE"
"1","      FALSE"
"1","
x.6 "
"1","     FALSE"
"1","      FALSE"
"1","
x.7 "
"1","     FALSE"
"1","      FALSE"
"1","
x.8 "
"1","     FALSE"
"1","      FALSE"
"1","
x.9 "
"1","     FALSE"
"1","      FALSE"
"1","
x.10"
"1","     FALSE"
"1","      FALSE"
"1","
x.11"
"1","     FALSE"
"1","      FALSE"
"1","
x.12"
"1","     FALSE"
"1","      FALSE"
"1","
x.13"
"1","     FALSE"
"1","      FALSE"
"1","
x.14"
"1","     FALSE"
"1","      FALSE"
"1","
x.15"
"1","     FALSE"
"1","      FALSE"
"1","
x.16"
"1","     FALSE"
"1","      FALSE"
"1","
x.17"
"1","     FALSE"
"1","      FALSE"
"1","
x.18"
"1","     FALSE"
"1","      FALSE"
"1","
x.19"
"1","     FALSE"
"1","      FALSE"
"1","
x.20"
"1","     FALSE"
"1","      FALSE"
"1","
"
"1","1"
"1"," subsets of each size up to "
"1","20"
"1","
"
"1","Selection Algorithm: "
"1","exhaustive"
"1","
"
"1","         "
"1"," x.1"
"1"," x.2"
"1"," x.3"
"1"," x.4"
"1"," x.5"
"1"," x.6"
"1"," x.7"
"1"," x.8"
"1"," x.9"
"1"," x.10"
"1"," x.11"
"1"," x.12"
"1"," x.13"
"1"," x.14"
"1"," x.15"
"1"," x.16"
"1"," x.17"
"1"," x.18"
"1"," x.19"
"1"," x.20"
"1","
1  ( 1 ) "
"1"," "" """
"1"," "" """
"1"," "" """
"1"," "" """
"1"," "" """
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1","
2  ( 1 ) "
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1","
3  ( 1 ) "
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," "" "" "
"1"," "" "" "
"1","
4  ( 1 ) "
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," "" "" "
"1"," "" "" "
"1","
5  ( 1 ) "
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1","
6  ( 1 ) "
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
7  ( 1 ) "
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," "" "" "
"1"," ""*"" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
8  ( 1 ) "
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
9  ( 1 ) "
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
10  ( 1 )"
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," "" "" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
11  ( 1 )"
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
12  ( 1 )"
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
13  ( 1 )"
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," "" """
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
14  ( 1 )"
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
15  ( 1 )"
"1"," ""*"""
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
16  ( 1 )"
"1"," ""*"""
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
17  ( 1 )"
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
18  ( 1 )"
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," "" "" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
19  ( 1 )"
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," "" """
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
20  ( 1 )"
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"""
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1"," ""*"" "
"1","
"
"0","mse.train = rep(NA, p)"
"0","x_cols = colnames(X_mat, do.NULL = FALSE, prefix = ""x."")"
"0","for(i in 1:p){"
"0","  c_i = coef(d.full, id = i)"
"0","  if(i > 1){"
"0","    Y.train.pred = as.matrix(X_mat.train[, x_cols %in% names(c_i)] %*% "
"0","                               c_i[names(c_i) %in% x_cols])"
"0","  }"
"0","  else"
"0","  {"
"0","    Y.train.pred = as.matrix(X_mat.train[, x_cols %in% names(c_i)] * "
"0","                               c_i[names(c_i) %in% x_cols])"
"0","  }"
"0","  "
"0","  mse.train[i] = mean((Y.train - Y.train.pred)^2) "
"0","}"
