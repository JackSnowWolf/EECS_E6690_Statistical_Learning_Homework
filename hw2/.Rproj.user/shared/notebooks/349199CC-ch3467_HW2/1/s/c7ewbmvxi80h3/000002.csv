"0","mse.test = rep(NA, p)"
"0","x_cols = colnames(X_mat, do.NULL = FALSE, prefix = ""x."")"
"0","for(i in 1:p){"
"0","  c_i = coef(d.full, id = i)"
"0","  if(i > 1){"
"0","    Y.test.pred = as.matrix(X_mat.test[, x_cols %in% names(c_i)] %*% "
"0","                               c_i[names(c_i) %in% x_cols])"
"0","  }"
"0","  else"
"0","  {"
"0","    Y.test.pred = as.matrix(X_mat.test[, x_cols %in% names(c_i)] * "
"0","                               c_i[names(c_i) %in% x_cols])"
"0","  }"
"0","  mse.test[i] = mean((Y.test - Y.test.pred)^2) "
"0","}"
